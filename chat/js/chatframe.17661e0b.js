(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chatframe"],{8866:function(t,c,n){"use strict";n.r(c);var s=function(){var t=this,c=t.$createElement,n=t._self._c||c;return n("div",{staticClass:"chat-frame_con"},[n("a-spin",{attrs:{size:"large",tip:"正在初始化...",spinning:t.spinning}},[n("a-row",{attrs:{type:"flex"}},[n("a-col",{staticClass:"side-bar",attrs:{flex:"88px"}},[n("svg-icon",{attrs:{"class-name":"logo","icon-class":"bizchat_logo"}}),n("account-list"),n("div",{staticClass:"bot-logo"},[n("svg-icon",{attrs:{"class-name":"icon-user","icon-class":"user_icon"}}),n("div",[t._v("ZMENG")])],1)],1),n("a-col",{attrs:{flex:"auto"}},[n("router-view")],1)],1)],1)],1)},o=[],e=n("6abc"),i=n("7736"),a=n("897c"),r=function(){var t=this,c=t.$createElement,n=t._self._c||c;return n("div",{staticClass:"act-list_container"},[t.accounts.length>0?n("div",t._l(t.accounts,(function(c){return n("div",{key:c.info.tjId,staticClass:"act-item",class:{active:t.curAct&&t.curAct.info.tjId===c.info.tjId},on:{click:function(n){return t.handleAct(c)}}},[n("a-badge",{attrs:{count:c.unread,"overflow-count":99}},[n("img",{attrs:{src:c.info.wechatAvatar,alt:""}})]),n("div",{staticClass:"nickname ellipsis",domProps:{innerHTML:t._s(c.info.wechatName)}})],1)})),0):t._e()])},u=[],d=(n("9065"),n("a336"),{name:"accountList",data:function(){return{curAct:null}},computed:{accounts:function(){return this.$store.state.accounts.accounts}},watch:{accounts:{immediate:!0,deep:!0,handler:function(){var t=this;if(this.$route.params.tjId?this.curAct=this.$store.getters.userDetailsById(this.$route.params.tjId):!this.curAct&&this.accounts.length>0&&(this.curAct=this.accounts[0],this.$route.matched.length<=1&&this.$router.replace({path:"/chatframe/".concat(this.curAct.info.tjId,"/recent/0")})),this.curAct){var c=this.curAct.info.tjId;this.$socket.emit("init",{tjId:c},(function(n){200===n.code&&t.$socket.emit("init_ack",{tjId:c})}))}}}},methods:{handleAct:function(t){var c=this,n=t.info.tjId;this.curAct.info.tjId!==n&&(this.curAct=t,this.$store.getters.contactByTjId(n)||this.$socket.emit("init",{tjId:n},(function(t){200===t.code&&c.$socket.emit("init_ack",{tjId:n})})),this.$router.push({path:"/chatframe/".concat(n,"/recent/0")}))}}}),h=d,f=(n("ec14"),n("5d22")),l=Object(f["a"])(h,r,u,!1,null,"78791a7f",null),m=l.exports,p={name:"chatFrame",components:{AccountList:m},data:function(){return{spinning:!0}},props:{saasId:{type:String}},methods:Object(e["a"])(Object(e["a"])({initSocket:function(){var t=this;console.log("%c ".concat(this.$store.state.token),"color:#02f;"),this.$socket.init("",{transports:["websocket"],query:{token:"".concat(this.$store.state.token)}}),this.$socket.emit("accounts",(function(c){200===c.code&&(t[a["a"]](c.data),t.spinning=!1)})),this.$socket.on("msg_history",(function(c){200===c.code&&t[a["o"]](c.data)})),this.$socket.on("msg_new",(function(c){t[a["o"]](c.data)})),this.$socket.on("contacts",(function(c){t[a["d"]](c.data)})),this.$socket.on("chat_list",(function(c){200===c.code&&t[a["c"]](c.data)})),this.$socket.on("customer_info",(function(c){200===c.code&&t[a["e"]](c.data)})),this.$socket.on("group_info",(function(c){200===c.code&&t[a["f"]](c.data)})),this.$socket.on("member_info",(function(c){200===c.code&&t[a["h"]](c.data)})),this.$socket.on("no_auth",(function(c){401===c.code&&t.$socket.close()})),this.$socket.on("connect_error",(function(){}))}},Object(i["b"])([a["o"],a["q"]])),Object(i["d"])([a["c"],a["a"],a["d"],a["e"],a["h"],a["f"]])),created:function(){this.initSocket()},beforeDestory:function(){this.$socket.close()}},k=p,$=(n("9893"),Object(f["a"])(k,s,o,!1,null,"26855100",null));c["default"]=$.exports},9893:function(t,c,n){"use strict";n("edff")},c83d:function(t,c,n){},ec14:function(t,c,n){"use strict";n("c83d")},edff:function(t,c,n){}}]);